!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e=e||self).testMatchingRoute={})}(this,function(e){"use strict";var t=g,r=f,n=function(e,t){return s(f(e,t))},o=s,i=h,a="/",p=new RegExp(["(\\\\.)","(?:\\:(\\w+)(?:\\(((?:\\\\.|[^\\\\()])+)\\))?|\\(((?:\\\\.|[^\\\\()])+)\\))([+*?])?"].join("|"),"g");function f(e,t){for(var r,n=[],o=0,i=0,f="",s=t&&t.delimiter||a,l=t&&t.whitelist||void 0,h=!1;null!==(r=p.exec(e));){var g=r[0],d=r[1],y=r.index;if(f+=e.slice(i,y),i=y+g.length,d)f+=d[1],h=!0;else{var m="",v=r[2],x=r[3],w=r[4],E=r[5];if(!h&&f.length){var b=f.length-1,$=f[b];(!l||l.indexOf($)>-1)&&(m=$,f=f.slice(0,b))}f&&(n.push(f),f="",h=!1);var R="+"===E||"*"===E,A="?"===E||"*"===E,T=x||w,j=m||s;n.push({name:v||o++,prefix:m,delimiter:j,optional:A,repeat:R,pattern:T?c(T):"[^"+u(j===s?j:j+s)+"]+?"})}}return(f||i<e.length)&&n.push(f+e.substr(i)),n}function s(e){for(var t=new Array(e.length),r=0;r<e.length;r++)"object"==typeof e[r]&&(t[r]=new RegExp("^(?:"+e[r].pattern+")$"));return function(r,n){for(var o="",i=n&&n.encode||encodeURIComponent,a=0;a<e.length;a++){var p=e[a];if("string"!=typeof p){var f,s=r?r[p.name]:void 0;if(Array.isArray(s)){if(!p.repeat)throw new TypeError('Expected "'+p.name+'" to not repeat, but got array');if(0===s.length){if(p.optional)continue;throw new TypeError('Expected "'+p.name+'" to not be empty')}for(var u=0;u<s.length;u++){if(f=i(s[u],p),!t[a].test(f))throw new TypeError('Expected all "'+p.name+'" to match "'+p.pattern+'"');o+=(0===u?p.prefix:p.delimiter)+f}}else if("string"!=typeof s&&"number"!=typeof s&&"boolean"!=typeof s){if(!p.optional)throw new TypeError('Expected "'+p.name+'" to be '+(p.repeat?"an array":"a string"))}else{if(f=i(String(s),p),!t[a].test(f))throw new TypeError('Expected "'+p.name+'" to match "'+p.pattern+'", but got "'+f+'"');o+=p.prefix+f}}else o+=p}return o}}function u(e){return e.replace(/([.+*?=^!:${}()[\]|\/\\])/g,"\\$1")}function c(e){return e.replace(/([=!:$\/()])/g,"\\$1")}function l(e){return e&&e.sensitive?"":"i"}function h(e,t,r){for(var n=(r=r||{}).strict,o=!1!==r.start,i=!1!==r.end,p=r.delimiter||a,f=[].concat(r.endsWith||[]).map(u).concat("$").join("|"),s=o?"^":"",c=0;c<e.length;c++){var h=e[c];if("string"==typeof h)s+=u(h);else{var g=h.repeat?"(?:"+h.pattern+")(?:"+u(h.delimiter)+"(?:"+h.pattern+"))*":h.pattern;t&&t.push(h),h.optional?h.prefix?s+="(?:"+u(h.prefix)+"("+g+"))?":s+="("+g+")?":s+=u(h.prefix)+"("+g+")"}}if(i)n||(s+="(?:"+u(p)+")?"),s+="$"===f?"$":"(?="+f+")";else{var d=e[e.length-1],y="string"==typeof d?d[d.length-1]===p:void 0===d;n||(s+="(?:"+u(p)+"(?="+f+"))?"),y||(s+="(?="+u(p)+"|"+f+")")}return new RegExp(s,l(r))}function g(e,t,r){return e instanceof RegExp?function(e,t){if(!t)return e;var r=e.source.match(/\((?!\?)/g);if(r)for(var n=0;n<r.length;n++)t.push({name:n,prefix:null,delimiter:null,optional:!1,repeat:!1,pattern:null});return e}(e,t):Array.isArray(e)?function(e,t,r){for(var n=[],o=0;o<e.length;o++)n.push(g(e[o],t,r).source);return new RegExp("(?:"+n.join("|")+")",l(r))}(e,t,r):function(e,t,r){return h(f(e,r),t,r)}(e,t,r)}t.parse=r,t.compile=n,t.tokensToFunction=o,t.tokensToRegExp=i;const d=new Map;function y(e,r={useMap:!0}){if(d.has(e)&&r.useMap)return d.get(e);var n=[],o=new t(e,n);return d.set(e,{re:o,keys:n}),{keys:n,re:o}}e.findMatchingRoutePath=function(e,t,r={}){const{return_matching_keys:n}=r;let o,i,a;return t=/\?[^\s]+$/.test(t)?t.replace(/^([^\s\?]+)\?[^\s]+$/,"$1"):t,(Array.isArray(e)?e:Object.keys(e)).forEach(function(e){var p=y(e,r);if(p.re.test(t)&&!o&&(o=e,a=p.re,n)){const e=p.re.exec(o),r=t.match(p.re);i=r.reduce((t,r,n)=>(0!==n&&"string"==typeof r&&(t[e[n].replace(":","")]=r),t),{})}}),n&&o?{route:o,location:t,params:i,re:a}:o},e.getParameterizedPath=y,e.ROUTE_MAP=d,Object.defineProperty(e,"__esModule",{value:!0})});
